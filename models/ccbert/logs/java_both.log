2023-11-12 20:48:43,962 	 Namespace(train_file_path='data/java.both.train.jsonl', val_file_path='data/java.both.valid.jsonl', test_file_path='data/java.both.test.jsonl', gen_gold_path='java_both.golden.txt', gen_pred_path='java_both.pred.txt', max_src_len=512, max_tgt_len=64, train_batch_size=8, test_batch_size=64, learning_rate=5e-05, dec_layers=6, beam_size=10, do_lower_case=True, weight_decay=0.0, model_name='microsoft/unixcoder-base-nine', best_rouge_model_save_path='java_both.brouge.pt', log_file='logs/java_both.log', load_model_from_epoch=0, last_best_rouge=0.2, epoch_model_save_path='java_both.pt', load_model_path='java_both.brouge.pt', gpu='0,1', random_seed=999, epoch=15, gradient_accumulation_steps=4, debug=0, generate=0, train=1, log_interval=100, score_interval=200, eval_interval=1750)
2023-11-12 20:48:43,962 	 GPU count 2, no. 0,1
2023-11-12 20:48:45,914 	 Starting new HTTPS connection (1): huggingface.co:443
2023-11-12 20:48:46,308 	 https://huggingface.co:443 "HEAD /microsoft/unixcoder-base-nine/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2023-11-12 20:49:46,633 	 Namespace(train_file_path='data/train.jsonl', val_file_path='data/valid.jsonl', test_file_path='data/test.jsonl', gen_gold_path='java_both.golden.txt', gen_pred_path='java_both.pred.txt', max_src_len=512, max_tgt_len=64, train_batch_size=8, test_batch_size=64, learning_rate=5e-05, dec_layers=6, beam_size=10, do_lower_case=True, weight_decay=0.0, model_name='microsoft/unixcoder-base-nine', best_rouge_model_save_path='java_both.brouge.pt', log_file='logs/java_both.log', load_model_from_epoch=0, last_best_rouge=0.2, epoch_model_save_path='java_both.pt', load_model_path='java_both.brouge.pt', gpu='0,1', random_seed=999, epoch=15, gradient_accumulation_steps=4, debug=0, generate=0, train=1, log_interval=100, score_interval=200, eval_interval=1750)
2023-11-12 20:49:46,633 	 GPU count 2, no. 0,1
2023-11-12 20:49:47,305 	 Starting new HTTPS connection (1): huggingface.co:443
2023-11-12 20:49:47,613 	 https://huggingface.co:443 "HEAD /microsoft/unixcoder-base-nine/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2023-11-12 20:50:11,922 	 Namespace(train_file_path='data/train.jsonl', val_file_path='data/valid.jsonl', test_file_path='data/test.jsonl', gen_gold_path='java_both.golden.txt', gen_pred_path='java_both.pred.txt', max_src_len=512, max_tgt_len=64, train_batch_size=8, test_batch_size=64, learning_rate=5e-05, dec_layers=6, beam_size=10, do_lower_case=True, weight_decay=0.0, model_name='microsoft/unixcoder-base-nine', best_rouge_model_save_path='java_both.brouge.pt', log_file='logs/java_both.log', load_model_from_epoch=0, last_best_rouge=0.2, epoch_model_save_path='java_both.pt', load_model_path='java_both.brouge.pt', gpu='0,1', random_seed=999, epoch=15, gradient_accumulation_steps=4, debug=0, generate=0, train=1, log_interval=100, score_interval=200, eval_interval=1750)
2023-11-12 20:50:11,922 	 GPU count 2, no. 0,1
2023-11-12 20:50:12,589 	 Starting new HTTPS connection (1): huggingface.co:443
2023-11-12 20:50:12,865 	 https://huggingface.co:443 "HEAD /microsoft/unixcoder-base-nine/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2023-11-12 20:50:53,449 	 Namespace(train_file_path='data/train.jsonl', val_file_path='data/valid.jsonl', test_file_path='data/test.jsonl', gen_gold_path='java_both.golden.txt', gen_pred_path='java_both.pred.txt', max_src_len=512, max_tgt_len=64, train_batch_size=8, test_batch_size=64, learning_rate=5e-05, dec_layers=6, beam_size=10, do_lower_case=True, weight_decay=0.0, model_name='microsoft/unixcoder-base-nine', best_rouge_model_save_path='java_both.brouge.pt', log_file='logs/java_both.log', load_model_from_epoch=0, last_best_rouge=0.2, epoch_model_save_path='java_both.pt', load_model_path='java_both.brouge.pt', gpu='0,1', random_seed=999, epoch=15, gradient_accumulation_steps=4, debug=0, generate=0, train=1, log_interval=100, score_interval=200, eval_interval=1750)
2023-11-12 20:50:53,449 	 GPU count 2, no. 0,1
2023-11-12 20:50:54,138 	 Starting new HTTPS connection (1): huggingface.co:443
2023-11-12 20:50:54,458 	 https://huggingface.co:443 "HEAD /microsoft/unixcoder-base-nine/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2023-11-12 20:51:34,481 	 Namespace(train_file_path='data/train.jsonl', val_file_path='data/valid.jsonl', test_file_path='data/test.jsonl', gen_gold_path='java_both.golden.txt', gen_pred_path='java_both.pred.txt', max_src_len=512, max_tgt_len=64, train_batch_size=8, test_batch_size=64, learning_rate=5e-05, dec_layers=6, beam_size=10, do_lower_case=True, weight_decay=0.0, model_name='microsoft/unixcoder-base-nine', best_rouge_model_save_path='java_both.brouge.pt', log_file='logs/java_both.log', load_model_from_epoch=0, last_best_rouge=0.2, epoch_model_save_path='java_both.pt', load_model_path='java_both.brouge.pt', gpu='0,1', random_seed=999, epoch=15, gradient_accumulation_steps=4, debug=0, generate=0, train=1, log_interval=100, score_interval=200, eval_interval=1750)
2023-11-12 20:51:34,481 	 GPU count 2, no. 0,1
2023-11-12 20:51:35,190 	 Starting new HTTPS connection (1): huggingface.co:443
2023-11-12 20:51:35,957 	 https://huggingface.co:443 "HEAD /microsoft/unixcoder-base-nine/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2023-11-12 20:51:42,580 	 dataloaders have been built
2023-11-12 20:51:42,838 	 https://huggingface.co:443 "HEAD /microsoft/unixcoder-base-nine/resolve/main/config.json HTTP/1.1" 200 0
2023-11-12 20:51:48,628 	 -------------start training-total 15 epoches------------
2023-11-12 20:51:48,628 	 -------every epoch has 2 batches-------
2023-11-12 20:51:48,628 	 **********************epoch 0********************* | Time 0m 0s
2023-11-12 20:51:48,628 	 -------start train-------
2023-11-12 20:53:45,554 	 Namespace(train_file_path='data/train.jsonl', val_file_path='data/valid.jsonl', test_file_path='data/test.jsonl', gen_gold_path='java_both.golden.txt', gen_pred_path='java_both.pred.txt', max_src_len=512, max_tgt_len=64, train_batch_size=8, test_batch_size=64, learning_rate=5e-05, dec_layers=6, beam_size=10, do_lower_case=True, weight_decay=0.0, model_name='microsoft/unixcoder-base-nine', best_rouge_model_save_path='java_both.brouge.pt', log_file='logs/java_both.log', load_model_from_epoch=0, last_best_rouge=0.2, epoch_model_save_path='java_both.pt', load_model_path='java_both.brouge.pt', gpu='0,1', random_seed=999, epoch=15, gradient_accumulation_steps=4, debug=0, generate=0, train=1, log_interval=100, score_interval=200, eval_interval=1750)
2023-11-12 20:53:45,554 	 GPU count 2, no. 0,1
2023-11-12 20:53:46,283 	 Starting new HTTPS connection (1): huggingface.co:443
2023-11-12 20:53:46,604 	 https://huggingface.co:443 "HEAD /microsoft/unixcoder-base-nine/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2023-11-12 20:53:53,472 	 dataloaders have been built
2023-11-12 20:53:53,726 	 https://huggingface.co:443 "HEAD /microsoft/unixcoder-base-nine/resolve/main/config.json HTTP/1.1" 200 0
2023-11-12 20:53:56,077 	 -------------start training-total 15 epoches------------
2023-11-12 20:53:56,077 	 -------every epoch has 2 batches-------
2023-11-12 20:53:56,077 	 **********************epoch 0********************* | Time 0m 0s
2023-11-12 20:53:56,077 	 -------start train-------
2023-11-12 20:53:58,172 	 **********************epoch 1********************* | Time 0m 2s
2023-11-12 20:53:58,172 	 -------start train-------
2023-11-12 20:53:59,532 	 **********************epoch 2********************* | Time 0m 3s
2023-11-12 20:53:59,532 	 -------start train-------
2023-11-12 20:54:00,911 	 **********************epoch 3********************* | Time 0m 4s
2023-11-12 20:54:00,911 	 -------start train-------
2023-11-12 20:54:02,307 	 **********************epoch 4********************* | Time 0m 6s
2023-11-12 20:54:02,307 	 -------start train-------
2023-11-12 20:54:04,458 	 **********************epoch 5********************* | Time 0m 8s
2023-11-12 20:54:04,458 	 -------start train-------
2023-11-12 20:54:09,213 	 **********************epoch 6********************* | Time 0m 13s
2023-11-12 20:54:09,214 	 -------start train-------
2023-11-12 20:54:15,803 	 **********************epoch 7********************* | Time 0m 19s
2023-11-12 20:54:15,804 	 -------start train-------
2023-11-12 20:54:21,623 	 **********************epoch 8********************* | Time 0m 25s
2023-11-12 20:54:21,623 	 -------start train-------
2023-11-12 20:54:26,917 	 **********************epoch 9********************* | Time 0m 30s
2023-11-12 20:54:26,918 	 -------start train-------
2023-11-12 20:54:56,187 	 Namespace(train_file_path='data/train.jsonl', val_file_path='data/valid.jsonl', test_file_path='data/test.jsonl', gen_gold_path='java_both.golden.txt', gen_pred_path='java_both.pred.txt', max_src_len=512, max_tgt_len=64, train_batch_size=8, test_batch_size=64, learning_rate=5e-05, dec_layers=6, beam_size=10, do_lower_case=True, weight_decay=0.0, model_name='microsoft/codebert-base', best_rouge_model_save_path='java_both.brouge.pt', log_file='logs/java_both.log', load_model_from_epoch=0, last_best_rouge=0.2, epoch_model_save_path='java_both.pt', load_model_path='java_both.brouge.pt', gpu='0,1', random_seed=999, epoch=15, gradient_accumulation_steps=4, debug=0, generate=0, train=1, log_interval=100, score_interval=200, eval_interval=1750)
2023-11-12 20:54:56,187 	 GPU count 2, no. 0,1
2023-11-12 20:54:56,899 	 Starting new HTTPS connection (1): huggingface.co:443
2023-11-12 20:54:57,371 	 https://huggingface.co:443 "HEAD /microsoft/codebert-base/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2023-11-12 20:55:04,441 	 dataloaders have been built
2023-11-12 20:55:04,767 	 https://huggingface.co:443 "HEAD /microsoft/codebert-base/resolve/main/config.json HTTP/1.1" 200 0
2023-11-12 20:55:10,334 	 -------------start training-total 15 epoches------------
2023-11-12 20:55:10,334 	 -------every epoch has 2 batches-------
2023-11-12 20:55:10,334 	 **********************epoch 0********************* | Time 0m 0s
2023-11-12 20:55:10,334 	 -------start train-------
2023-11-12 20:55:18,017 	 **********************epoch 1********************* | Time 0m 7s
2023-11-12 20:55:18,017 	 -------start train-------
2023-11-12 20:55:24,225 	 **********************epoch 2********************* | Time 0m 13s
2023-11-12 20:55:24,226 	 -------start train-------
2023-11-12 21:00:37,359 	 Namespace(train_file_path='data/train.jsonl', val_file_path='data/valid.jsonl', test_file_path='data/test.jsonl', gen_gold_path='java_both.golden.txt', gen_pred_path='java_both.pred.txt', max_src_len=512, max_tgt_len=64, train_batch_size=8, test_batch_size=64, learning_rate=5e-05, dec_layers=6, beam_size=10, do_lower_case=True, weight_decay=0.0, model_name='microsoft/codebert-base', best_rouge_model_save_path='java_both.brouge.pt', log_file='logs/java_both.log', load_model_from_epoch=0, last_best_rouge=0.2, epoch_model_save_path='java_both.pt', load_model_path='java_both.brouge.pt', gpu='0,1', random_seed=999, epoch=1, gradient_accumulation_steps=4, debug=0, generate=1, train=1, log_interval=100, score_interval=200, eval_interval=1750)
2023-11-12 21:00:37,359 	 GPU count 2, no. 0,1
2023-11-12 21:00:38,053 	 Starting new HTTPS connection (1): huggingface.co:443
2023-11-12 21:00:38,852 	 https://huggingface.co:443 "HEAD /microsoft/codebert-base/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2023-11-12 21:00:45,585 	 dataloaders have been built
2023-11-12 21:00:46,304 	 https://huggingface.co:443 "HEAD /microsoft/codebert-base/resolve/main/config.json HTTP/1.1" 200 0
2023-11-12 21:00:48,386 	 ----load model java_both.brouge.pt---
2023-11-12 21:01:45,589 	 Namespace(train_file_path='data/train.jsonl', val_file_path='data/valid.jsonl', test_file_path='data/test.jsonl', gen_gold_path='java_both.golden.txt', gen_pred_path='java_both.pred.txt', max_src_len=512, max_tgt_len=64, train_batch_size=8, test_batch_size=64, learning_rate=5e-05, dec_layers=6, beam_size=10, do_lower_case=True, weight_decay=0.0, model_name='microsoft/codebert-base', best_rouge_model_save_path='java_both.brouge.pt', log_file='logs/java_both.log', load_model_from_epoch=0, last_best_rouge=0.2, epoch_model_save_path='java_both.pt', load_model_path='java_both.brouge.pt', gpu='0,1', random_seed=999, epoch=1, gradient_accumulation_steps=4, debug=0, generate=0, train=1, log_interval=100, score_interval=200, eval_interval=1)
2023-11-12 21:01:45,589 	 GPU count 2, no. 0,1
2023-11-12 21:01:46,290 	 Starting new HTTPS connection (1): huggingface.co:443
2023-11-12 21:01:47,091 	 https://huggingface.co:443 "HEAD /microsoft/codebert-base/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2023-11-12 21:01:53,868 	 dataloaders have been built
2023-11-12 21:01:54,605 	 https://huggingface.co:443 "HEAD /microsoft/codebert-base/resolve/main/config.json HTTP/1.1" 200 0
2023-11-12 21:01:56,701 	 -------------start training-total 1 epoches------------
2023-11-12 21:01:56,701 	 -------every epoch has 2 batches-------
2023-11-12 21:01:56,701 	 **********************epoch 0********************* | Time 0m 0s
2023-11-12 21:01:56,702 	 -------start train-------
2023-11-12 21:01:57,441 	 ------start evaluation------
2023-11-12 21:02:20,229 	 Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
2023-11-12 21:02:21,019 	 Creating converter from 7 to 5
2023-11-12 21:02:21,019 	 Creating converter from 5 to 7
2023-11-12 21:02:21,019 	 Creating converter from 7 to 5
2023-11-12 21:02:21,019 	 Creating converter from 5 to 7
2023-11-12 21:02:24,415 	 	Eval Rouge: 0.03252525219598256
2023-11-12 21:02:25,087 	 	Save Best Rouge on Val
2023-11-12 21:02:25,284 	 ------start evaluation------
2023-11-12 21:02:39,664 	 	Eval Rouge: 0.03252525219598256
2023-11-13 15:44:04,985 	 Namespace(train_file_path='/media/data/thanhnb/dataset1/Copying-enhanced-CodeBERT/models/ccbert/data/train.csv', val_file_path='/media/data/thanhnb/dataset1/Copying-enhanced-CodeBERT/models/ccbert/data/valid.csv', test_file_path='/media/data/thanhnb/dataset1/Copying-enhanced-CodeBERT/models/ccbert/data/test.csv', gen_gold_path='java_both.golden.txt', gen_pred_path='java_both.pred.txt', max_src_len=256, max_tgt_len=64, train_batch_size=8, test_batch_size=64, learning_rate=5e-05, dec_layers=6, beam_size=10, do_lower_case=True, weight_decay=0.0, model_name='distilroberta-base', best_rouge_model_save_path='java_both.brouge.pt', log_file='logs/java_both.log', load_model_from_epoch=0, last_best_rouge=0.2, epoch_model_save_path='java_both.pt', load_model_path='java_both.brouge.pt', gpu='0,1', random_seed=999, epoch=1, gradient_accumulation_steps=4, debug=0, generate=0, train=1, log_interval=100, score_interval=200, eval_interval=450000)
2023-11-13 15:44:05,021 	 GPU count 2, no. 0,1
2023-11-13 15:44:06,652 	 Starting new HTTPS connection (1): huggingface.co:443
2023-11-13 15:44:07,004 	 https://huggingface.co:443 "HEAD /distilroberta-base/resolve/main/tokenizer_config.json HTTP/1.1" 404 0
2023-11-13 15:44:07,291 	 https://huggingface.co:443 "HEAD /distilroberta-base/resolve/main/vocab.json HTTP/1.1" 200 0
